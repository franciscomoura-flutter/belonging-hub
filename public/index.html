<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Belonging Hub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <script>document.documentElement.classList.add('is-loading');</script>
    <link rel="preload" as="image" href="assets/img/hero-background.png" fetchpriority="high">
    <link rel="preload" as="video" href="assets/video/sample.mp4" type="video/mp4" fetchpriority="high">
</head>

<body>
    <div id="appLoader" class="app-loader">
        <div class="spinner"></div>
        <p>Loading experience...</p>
    </div>
    <div class="navbar">
        <div class="navbar-left">
            <a class="navbar-brand" href="#" onclick="showMain('home')">
                <img src="assets/img/logo.png" alt="Logo" height="50">
            </a>
        </div>
        <div class="navbar-right">
            <a class="navbar-link navbar-journey" href="#" onclick="showMain('journey')">Your Journey</a>
            <a class="navbar-link navbar-principles" href="#" onclick="showMain('principles')">Belonging Principles</a>
        </div>
    </div>

    <main id="home">
        <div class="hero-container">
            <div class="hero-video">
                <video autoplay loop muted playsinline preload="auto" poster="assets/img/hero-background.png">
                    <source src="assets/video/sample.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="hero-overlay">
                <img src="assets/img/hero-background.png" alt="Overlay">
            </div>
            <div class="hero-content">
                <div class="hero-left">
                    <span class="hero-subtitle">Welcome to the</span>
                    <span class="hero-title">Belonging Hub</span>
                    <span class="hero-description">This is your space to learn, reflect, and take action toward building
                        a
                        more inclusive workplace where everyone feels
                        seen, valued, and empowered to thrive. <span style="font-weight: 500;">Let’s grow
                            together.</span></span>
                    <div class="hero-controls">
                        <button id="playPauseBtn" aria-label="Pause">
                            <span id="playPauseIcon"></span>
                        </button>
                        <button id="muteBtn" aria-label="Unmute">
                            <span id="muteIcon"></span>
                        </button>
                    </div>
                </div>
                <div class="hero-right"></div>
            </div>
        </div>
        <div class="section-explore">
            <h1 class="section-title">Explore the Hub.</h1>
            <div class="section-explore-cards">
                <div class="section-explore-main-card" id="exploreMainCard">
                    <video id="exploreMainVideo" preload="metadata">
                        <source src="assets/video/sample.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div class="explore-main-overlay-text">
                        We have a range of resources designed to support you on your Inclusion journey.
                    </div>
                    <button id="explorePlayBtn" class="explore-play-button" aria-label="Play explore video"></button>
                </div>
                <div class="section-explore-sub-cards">
                    <div class="section-explore-sub-card">
                        <p>FOR</p><span>Everyone</span>
                    </div>
                    <div class="section-explore-sub-card">
                        <p>FOR</p><span>Managers</span>
                    </div>
                    <div class="section-explore-sub-card">
                        <p>FOR</p><span>Hiring Managers</span>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <main id="journey" style="display:none;">
        <div class="back-home-btn">
            <span onclick="showMain('home')">&#8592; Back to Home</span>
        </div>
        <span class="section-title">Your Journey.</span>
        <p>Content for Your Journey.</p>
    </main>
    <main id="principles" style="display:none;">
        <div class="back-home-btn">
            <span onclick="showMain('home')">&#8592; Back to Home</span>
        </div>
        <div class="principles-header">
            <span class="section-title">Why Inclusion & Belonging Matter</span>
            <span class="section-description">Inclusion isn’t a nice-to-have, <span style="font-weight: 600;">it’s a
                    must.</span> Diversity, Equity, and Inclusion fuel trust, innovation, and stronger teams. <br>
                Discover why DEI is essential to who we are and what we do, and how it drives better outcomes for
                everyone.</span>
        </div>

        <div id="principlesPlaylist" class="video-playlist" data-playlist>
            <div class="playlist-source">
                <article id="principle-1" data-src="assets/video/sample.mp4"
                    data-poster="assets/img/hero-background.png">
                    <h4>1. Why Inclusion & Belonging Matter</h4>
                    <p class="short">For All of Us</p>
                    <p class="description">
                        Set the foundation by showing how inclusion is essential to everyone—not just underrepresented
                        groups.
                    </p>
                </article>
                <article id="principle-2" data-src="assets/video/sample.mp4"
                    data-poster="assets/img/Belonging at Blip Photo 10.jpg">
                    <h4>2. Understanding Psychological Safety and Empathy</h4>
                    <p class="short">Foster a Safe Environment</p>
                    <p class="description">
                        Introduce psychological safety as the emotional foundation for belonging.​
                    </p>
                </article>
                <article id="principle-3" data-src="assets/video/sample.mp4"
                    data-poster="assets/img/Belonging at Blip Photo 13.jpg">
                    <h4>3. Mythbusting DEI: What it is VS What it’s not</h4>
                    <p class="short">Addressing Misunderstandings</p>
                    <p class="description">
                        Address common misunderstandings about diversity, equity, and inclusion.
                    </p>
                </article>
                <article id="principle-4" data-src="assets/video/sample.mp4"
                    data-poster="assets/img/Belonging at Blip Photo 14.jpg">
                    <h4>4. Allyship in Action</h4>
                    <p class="short">Understanding Allyship</p>
                    <p class="description">
                        Show what real allyship looks like and how everyone can practice it.​
                    </p>
                </article>
            </div>
        </div>
    </main>

    <script>
        function showMain(id) {
            ['home', 'journey', 'principles'].forEach(sec => {
                const el = document.getElementById(sec);
                if (el) el.style.display = (sec === id) ? 'flex' : 'none';
            });
            if (id !== 'home' && window.heroVideo) {
                window.userPausedHero = true;
                if (!window.heroVideo.paused) window.heroVideo.pause();
            }
            if (id === 'principles') {
                const root = document.getElementById('principlesPlaylist');
                if (root) enhanceVideoPlaylistFromMarkup(root, { autoplayFirst: true });
            }
        }

        (function () {
            const criticalImages = [
                'assets/img/hero-background.png',
                'assets/img/Belonging at Blip Photo 10.jpg',
                'assets/img/Belonging at Blip Photo 13.jpg',
                'assets/img/Belonging at Blip Photo 14.jpg'
            ];

            function loadImage(src) {
                return new Promise(res => {
                    const img = new Image();
                    img.onload = img.onerror = () => res();
                    img.src = src;
                });
            }

            function waitForVideoFirstFrame(video) {
                return new Promise(res => {
                    if (!video) return res();
                    if (video.readyState >= 2) return res(); // HAVE_CURRENT_DATA
                    const onData = () => { video.removeEventListener('loadeddata', onData); res(); };
                    video.addEventListener('loadeddata', onData);
                    setTimeout(res, 4000); // safety timeout
                });
            }

            window.__appReady = (async () => {
                const heroVideo = document.querySelector('.hero-video video');
                await Promise.all([
                    ...criticalImages.map(loadImage),
                    waitForVideoFirstFrame(heroVideo)
                ]);
            })().then(() => {
                document.documentElement.classList.add('app-loaded');
                document.documentElement.classList.remove('is-loading');
                // Trigger initial height after reveal
                try {
                    parent.postMessage({ type: 'bh-resize', height: document.documentElement.scrollHeight }, '*');
                } catch (_) { }
                // Remove loader node after fade
                setTimeout(() => {
                    const l = document.getElementById('appLoader');
                    l && l.remove();
                }, 600);
            });
        })();

        (function () {
            // Expose hero video refs globally after initAppLogic runs
            document.addEventListener('DOMContentLoaded', () => {
                // After your initAppLogic executes it sets heroVideo locally.
                // We hook into it by polling once (safe + lightweight).
                const tryAssign = () => {
                    const hv = document.querySelector('.hero-video video');
                    if (hv) window.heroVideo = hv;
                };
                tryAssign();
            });
        })();

        document.addEventListener('DOMContentLoaded', function () {
            if (window.__appReady) {
                window.__appReady.then(initAppLogic);
            } else {
                initAppLogic();
            }

            function initAppLogic() {
                const pauseSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M18.535 4.766c.73.27 1.215.965 1.215 1.743V17.49c0 .778-.485 1.474-1.215 1.743a4.44 4.44 0 0 1-3.07 0a1.86 1.86 0 0 1-1.215-1.743V6.51c0-.778.485-1.474 1.215-1.743a4.44 4.44 0 0 1 3.07 0M18.25 6.51a.36.36 0 0 0-.234-.335a2.94 2.94 0 0 0-2.032 0a.36.36 0 0 0-.234.335v10.98c0 .15.093.284.234.335a2.94 2.94 0 0 0 2.032 0a.36.36 0 0 0 .234-.335zM8.535 4.766c.73.27 1.215.965 1.215 1.743V17.49c0 .778-.485 1.474-1.215 1.743a4.44 4.44 0 0 1-3.07 0A1.86 1.86 0 0 1 4.25 17.49V6.51c0-.778.485-1.474 1.215-1.743a4.44 4.44 0 0 1 3.07 0M8.25 6.51a.36.36 0 0 0-.234-.335a2.94 2.94 0 0 0-2.032 0a.36.36 0 0 0-.234.335v10.98c0 .15.093.284.234.335a2.94 2.94 0 0 0 2.032 0a.36.36 0 0 0 .234-.335z" clip-rule="evenodd"/></svg>`;
                const playSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M16.394 12L10 7.737v8.526zm2.982.416L8.777 19.482A.5.5 0 0 1 8 19.066V4.934a.5.5 0 0 1 .777-.416l10.599 7.066a.5.5 0 0 1 0 .832"/></svg>`;
                const unmuteSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3.75v16.5a.75.75 0 0 1-1.255.555L5.46 16H2.75A1.75 1.75 0 0 1 1 14.25v-4.5C1 8.784 1.784 8 2.75 8h2.71l5.285-4.805A.75.75 0 0 1 12 3.75M6.255 9.305a.75.75 0 0 1-.505.195h-3a.25.25 0 0 0-.25.25v4.5c0 .138.112.25.25.25h3c.187 0 .367.069.505.195l4.245 3.86V5.445ZM16.28 8.22a.75.75 0 1 0-1.06 1.06L17.94 12l-2.72 2.72a.75.75 0 1 0 1.06 1.06L19 13.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L20.06 12l2.72-2.72a.75.75 0 0 0-1.06-1.06L19 10.94z"/></svg>`;
                const muteSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M11.553 3.064A.75.75 0 0 1 12 3.75v16.5a.75.75 0 0 1-1.255.555L5.46 16H2.75A1.75 1.75 0 0 1 1 14.25v-4.5C1 8.784 1.784 8 2.75 8h2.71l5.285-4.805a.75.75 0 0 1 .808-.13ZM10.5 5.445l-4.245 3.86a.75.75 0 0 1-.505.195h-3a.25.25 0 0 0-.25.25v4.5c0 .138.112.25.25.25h3c.187 0 .367.069.505.195l4.245 3.86Zm8.218-1.223a.75.75 0 0 1 1.06 0c4.296 4.296 4.296 11.26 0 15.556a.75.75 0 0 1-1.06-1.06a9.5 9.5 0 0 0 0-13.436a.75.75 0 0 1 0-1.06"/><path fill="currentColor" d="M16.243 7.757a.75.75 0 1 0-1.061 1.061a4.5 4.5 0 0 1 0 6.364a.75.75 0 0 0 1.06 1.06a6 6 0 0 0 0-8.485Z"/></svg>`;

                const heroVideo = document.querySelector('.hero-video video');
                const playPauseBtn = document.getElementById('playPauseBtn');
                const muteBtn = document.getElementById('muteBtn');
                const playPauseIcon = document.getElementById('playPauseIcon');
                const muteIcon = document.getElementById('muteIcon');
                let userPausedHero = false;

                function setPlayPauseIcon() {
                    if (heroVideo.paused) {
                        playPauseIcon.innerHTML = playSVG;
                        playPauseBtn.setAttribute('aria-label', 'Play');
                    } else {
                        playPauseIcon.innerHTML = pauseSVG;
                        playPauseBtn.setAttribute('aria-label', 'Pause');
                    }
                }

                function setMuteIcon() {
                    if (heroVideo.muted) {
                        muteIcon.innerHTML = unmuteSVG;
                        muteBtn.setAttribute('aria-label', 'Unmute');
                    } else {
                        muteIcon.innerHTML = muteSVG;
                        muteBtn.setAttribute('aria-label', 'Mute');
                    }
                }

                playPauseBtn.addEventListener('click', function () {
                    if (heroVideo.paused) {
                        heroVideo.play();
                        userPausedHero = false;
                    } else {
                        heroVideo.pause();
                        userPausedHero = true;
                    }
                    setPlayPauseIcon();
                });

                muteBtn.addEventListener('click', function () {
                    heroVideo.muted = !heroVideo.muted;
                    setMuteIcon();
                });

                heroVideo.addEventListener('pause', () => {
                    if (!userPausedHero && document.getElementById('home').style.display !== 'none') {
                        heroVideo.play().catch(() => { });
                    }
                    setPlayPauseIcon();
                });

                heroVideo.addEventListener('play', setPlayPauseIcon);
                heroVideo.addEventListener('volumechange', setMuteIcon);

                setPlayPauseIcon();
                setMuteIcon();

                const exploreCard = document.getElementById('exploreMainCard');
                const exploreVideo = document.getElementById('exploreMainVideo');
                const explorePlayBtn = document.getElementById('explorePlayBtn');

                explorePlayBtn.innerHTML = playSVG;

                exploreVideo.removeAttribute('controls');

                function enterPlayingState() {
                    exploreCard.classList.add('playing');
                    if (!exploreVideo.hasAttribute('controls')) {
                        exploreVideo.setAttribute('controls', 'controls');
                    }
                }

                function leavePlayingState() {
                    exploreCard.classList.remove('playing');
                    if (exploreVideo.hasAttribute('controls')) {
                        exploreVideo.removeAttribute('controls');
                    }
                }

                exploreCard.addEventListener('click', function () {
                    if (exploreVideo.paused) {
                        exploreVideo.play().catch(() => { });
                    }
                });

                explorePlayBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    if (exploreVideo.paused) {
                        exploreVideo.play().catch(() => { });
                    }
                });

                exploreVideo.addEventListener('play', () => {
                    enterPlayingState();
                    if (heroVideo.paused && !userPausedHero) {
                        heroVideo.play().catch(() => { });
                    }
                });

                exploreVideo.addEventListener('pause', leavePlayingState);
                exploreVideo.addEventListener('ended', () => {
                    exploreVideo.currentTime = 0;
                    leavePlayingState();
                });
            }
        });

        /**
         * Enhance any .video-playlist[data-playlist] container that has
         * a .playlist-source with <article data-src ...> children.
         */
        function enhanceVideoPlaylistFromMarkup(root, options = {}) {
            if (!root || root.dataset.enhanced === 'true') return;
            const sourceWrapper = root.querySelector('.playlist-source');
            if (!sourceWrapper) return;

            const articles = [...sourceWrapper.querySelectorAll('article[data-src]')];
            if (!articles.length) return;

            const items = articles.map((art, i) => {
                const title = (art.querySelector('h4')?.textContent || art.dataset.title || `Video ${i + 1}`).trim();
                const short = (art.querySelector('.short')?.textContent || art.dataset.short || '').trim();
                const descEl = art.querySelector('.description');
                const description = descEl ? descEl.textContent.trim() : (art.textContent || '').trim();
                return {
                    id: art.id || `video-${i}`,
                    title,
                    short,
                    description,
                    src: art.dataset.src,
                    poster: art.dataset.poster || ''
                };
            });

            root.dataset.enhanced = 'true';

            const main = document.createElement('div');
            main.className = 'video-playlist-main';
            main.innerHTML = `
                <div class="video-wrapper">
                    <video class="playlist-main-video" playsinline controls preload="metadata"></video>
                </div>
                <div class="video-playlist-info">
                    <h3 class="video-title"></h3>
                    <p class="video-description"></p>
                </div>
            `;

            const side = document.createElement('div');
            side.className = 'video-playlist-side';
            side.innerHTML = `
                <span class="video-playlist-side-header" aria-hidden="true">Playlist (${items.length})</span>
                <div class="video-playlist-list" role="listbox" aria-label="Video playlist"></div>
            `;

            root.appendChild(main);
            root.appendChild(side);

            const videoEl = main.querySelector('.playlist-main-video');
            const titleEl = main.querySelector('.video-title');
            const descEl = main.querySelector('.video-description');
            const listEl = side.querySelector('.video-playlist-list');

            const state = { currentIndex: 0, items };

            function renderList() {
                listEl.innerHTML = '';
                state.items.forEach((item, idx) => {
                    const li = document.createElement('div');
                    li.className = 'playlist-item' + (idx === state.currentIndex ? ' active' : '');
                    li.setAttribute('role', 'option');
                    li.setAttribute('aria-selected', idx === state.currentIndex ? 'true' : 'false');
                    li.dataset.index = String(idx);
                    li.innerHTML = `
                        <div class="playlist-thumb">
                            <img loading="lazy" src="${item.poster || 'assets/img/hero-background.png'}" alt="${item.title}">
                        </div>
                        <div class="playlist-meta">
                            <div class="playlist-meta-title">${item.title}</div>
                            <div class="playlist-meta-desc">${item.short || ''}</div>
                        </div>
                        <button type="button" aria-label="Play ${item.title}"></button>
                    `;
                    li.addEventListener('click', () => selectIndex(idx, true));
                    listEl.appendChild(li);
                });
            }

            function updateActive() {
                [...listEl.children].forEach((c, i) => {
                    const active = i === state.currentIndex;
                    c.classList.toggle('active', active);
                    c.setAttribute('aria-selected', active ? 'true' : 'false');
                });
            }

            function loadCurrent(autoplay) {
                const item = state.items[state.currentIndex];
                if (!item) return;
                if (videoEl.src !== item.src) videoEl.src = item.src;
                if (item.poster) videoEl.poster = item.poster;
                titleEl.textContent = item.title;
                descEl.textContent = item.description || '';
                updateActive();
                if (autoplay) videoEl.play().catch(() => { });
                try {
                    parent.postMessage({ type: 'bh-resize', height: document.documentElement.scrollHeight }, '*');
                } catch { }
            }

            function selectIndex(idx, autoplay) {
                if (idx < 0 || idx >= state.items.length || idx === state.currentIndex) return;
                state.currentIndex = idx;
                loadCurrent(autoplay);
            }

            renderList();
            loadCurrent(options.autoplayFirst !== false);
        }

        (function () {
            function sendHeight() {
                const h = document.documentElement.scrollHeight;
                parent.postMessage({ type: 'bh-resize', height: h }, '*');
            }
            window.addEventListener('load', sendHeight);
            new ResizeObserver(sendHeight).observe(document.body);
            setInterval(sendHeight, 1000);
        })();
    </script>
</body>

</html>